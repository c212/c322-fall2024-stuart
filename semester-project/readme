Thanks to Leo for checking this code.
